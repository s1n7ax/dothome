#!/usr/bin/env nu

module files {
  def is_file [path] {
    ($path | path expand | path type) == 'file'
  }

  def is_dir [path] {
    ($path | path expand | path type) == 'dir'
  }

  def get_list_of_files_from_dir [dir: string] {
    (ls $"($dir)/**/*" | find file | get name)
  }

  export def getfiles [paths] {
    $paths | each {|file| 
      if (is_file $file) {
        $file
      } else if (is_dir $file) {
        ((get_list_of_files_from_dir $file) | each { echo $in })
      }
    } | flatten
  }
}

def main [...paths: string] {
  use files getfiles;

  (getfiles $paths)
}
