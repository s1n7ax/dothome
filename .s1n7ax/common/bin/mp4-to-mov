#!/bin/bash

set -euxo pipefail


if [[ $# -eq 0 ]] ; then
    echo 'Converting all the files in the current dir to mov'

    mkdir -p converted
    ls *.mp4 | \
    xargs -I {} basename {} .mp4 | \
    xargs -I {} \
    sh -c 'ffmpeg -i "{}.mp4" -f mov "{}.mov"'

    exit 0
  else
    echo 'Converting "$1" to mov'

    ABSOLUTE_PATH=$(realpath "$1")
    FILE_PATH_WITHOUT_EXT="${ABSOLUTE_PATH%%.*}"
    TARGET_PATH="$FILE_PATH_WITHOUT_EXT.mov"

    exit 0
fi

